---
title: 线程>线程池>协程 多线程的演变
date: 2023-10-27 19:10:19
tags:
- 线程
- 线程池
- 协程
---

线程简单使用
> 1. MyThread extends Thread 实现run方法 new MyThread().start();

> 2. MyRunnable implements Runnable 实现run方法 new Thread(new MyRunnable()).start();

> 3. 通过Future

线程池-享元模式
> 通过池化技术重复利用线程
![](pool.png)
> ！！！ 以上四种都不建议使用、建议通过ThreadPoolExecutor()根据需求定制
> 定制时coreSize选择问题：
> 1. cpu密集型 系统cpu内核数量加一 n+1 （+1是为了容错，在某线程异常时顶上）
> 2. io型 2 * n （这里假设io耗时占总耗时一半，如果更高按比例提升系数）
> 
> 进阶问题：
> 0. 大型app有多个线程池场景 - 可按紧急度分类建立多个线程池由hashmap缓存
> 1. 大型app在不同场景需要倾斜资源保障流畅，比如打开扫一扫 应该优先执行相关任务
> 2. 线程池调度单位是线程，需要更细化的调度

协程
> 进程是系统资源分配的最小单位，线程是系统资源调度的最小单位
> 协程就是为了更充分调动资源，在线程池基础上对task进行调度管理
支付宝的协程实现
![](zfb.awebp)

kotlin协程
![](coroutines.png)
![](coroutine_.awebp)






- > 美团技术<https://tech.meituan.com/2020/04/02/java-pooling-pratice-in-meituan.html>
- > <https://leo-wxy.github.io/2020/09/04/Kotlin%E5%8D%8F%E7%A8%8B%E5%8E%9F%E7%90%86/>
- > 支付宝类协程<https://juejin.cn/post/7134633543426113544>